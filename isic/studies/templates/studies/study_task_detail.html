{% extends 'core/base.html' %}
{% load humanize %}

{% block content %}

  {% if request.user != study_task.annotator %}
    Warning: you're not the expected annotator, you shouldn't fill this out, {{ study_task.annotator }} should.
  {% endif %}

  <div class="flex mt-2">
  <div class="w-3/4 lg:w-4/5 xl:w-2/3 mr-8">
    <div x-data="{ open: false, hovered: false }" class="fixed z-0" style="width: inherit;">
      <div class="mb-2" style="width: inherit;">
        <h2>{{ study_task.study.name }}</h2>
        {{ tasks_remaining|intcomma }} tasks remaining in this study.
      </div>
      <a class="cursor-pointer" style="width: inherit;">
        {% if debug %}
          <img class="max-w-full h-auto" style="width: inherit;" @mouseenter="hovered = true" @click="open = true" src="https://picsum.photos/seed/{{study_task.image.id}}/2000/1000">
        {% else %}
          <img class="max-w-full h-auto" @mouseenter="hovered = true" @click="open = true" src="{{ study_task.image.accession.blob.url }}" title="{{ study_task.image.accession.blob_name }}" />
        {% endif %}
      </a>

      <template x-if="true">
        <div x-show="open">
          {% include 'core/partials/image_modal.html' with image=study_task.image %}
        </div>
      </template>
    </div>
  </div>
    {% if study_task.complete %}
      You've finished this task.
    {% else %}
      <form class="w-1/3 relative z-10" method="POST" action="">
        {% csrf_token %}
        {{ form.non_field_errors  }}
        {% for field in form %}
          <div class="mb-4">
            {{ field.errors }}
            {{ field.label }}
            {{ field }}
          </div>
        {% endfor %}
        <button type="submit"
          class="mt-4 inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
          Respond and continue
        </button>
      </form>
    {% endif %}
  </div>
{% endblock %}
