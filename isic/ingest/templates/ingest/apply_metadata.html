{% extends 'core/base.html' %}

{% block content %}
  {% include 'ingest/partials/breadcrumbs.html' %}

  <fieldset>
    <legend class="sr-only">
      Privacy setting
    </legend>
    <div class="bg-white rounded-md -space-y-px">
      <!-- Checked: "bg-indigo-50 border-indigo-200 z-10", Not Checked: "border-gray-200" -->
      <label class="border-gray-200 rounded-tl-md rounded-tr-md relative border p-4 flex cursor-pointer">
        <input type="radio" name="privacy_setting" value="Public access" class="h-4 w-4 mt-0.5 cursor-pointer text-indigo-600 border-gray-300 focus:ring-indigo-500" aria-labelledby="privacy-setting-0-label" aria-describedby="privacy-setting-0-description">
        <div class="ml-3 flex flex-col">
          <!-- Checked: "text-indigo-900", Not Checked: "text-gray-900" -->
          <span id="privacy-setting-0-label" class="text-gray-900 block text-sm font-medium">
            Public access
          </span>
          <!-- Checked: "text-indigo-700", Not Checked: "text-gray-500" -->
          <span id="privacy-setting-0-description" class="text-gray-500 block text-sm">
            This project would be available to anyone who has the link
          </span>
        </div>
      </label>

      <!-- Checked: "bg-indigo-50 border-indigo-200 z-10", Not Checked: "border-gray-200" -->
      <label class="border-gray-200 relative border p-4 flex cursor-pointer">
        <input type="radio" name="privacy_setting" value="Private to Project Members" class="h-4 w-4 mt-0.5 cursor-pointer text-indigo-600 border-gray-300 focus:ring-indigo-500" aria-labelledby="privacy-setting-1-label" aria-describedby="privacy-setting-1-description">
        <div class="ml-3 flex flex-col">
          <!-- Checked: "text-indigo-900", Not Checked: "text-gray-900" -->
          <span id="privacy-setting-1-label" class="text-gray-900 block text-sm font-medium">
            Private to Project Members
          </span>
          <!-- Checked: "text-indigo-700", Not Checked: "text-gray-500" -->
          <span id="privacy-setting-1-description" class="text-gray-500 block text-sm">
            Only members of this project would be able to access
          </span>
        </div>
      </label>

      <!-- Checked: "bg-indigo-50 border-indigo-200 z-10", Not Checked: "border-gray-200" -->
      <label class="border-gray-200 rounded-bl-md rounded-br-md relative border p-4 flex cursor-pointer">
        <input type="radio" name="privacy_setting" value="Private to you" class="h-4 w-4 mt-0.5 cursor-pointer text-indigo-600 border-gray-300 focus:ring-indigo-500" aria-labelledby="privacy-setting-2-label" aria-describedby="privacy-setting-2-description">
        <div class="ml-3 flex flex-col">
          <!-- Checked: "text-indigo-900", Not Checked: "text-gray-900" -->
          <span id="privacy-setting-2-label" class="text-gray-900 block text-sm font-medium">
            Private to you
          </span>
          <!-- Checked: "text-indigo-700", Not Checked: "text-gray-500" -->
          <span id="privacy-setting-2-description" class="text-gray-500 block text-sm">
            You are the only one able to access this project
          </span>
        </div>
      </label>
    </div>
  </fieldset>



  <div class="mt-6">
    <ul class="bg-gray-50 border border-gray-200 rounded-md divide-y divide-gray-200">
      {% for metadata_file in cohort.metadata_files.all %}
        <li class="py-4 px-6">
          <div class="flex items-center space-x-4">
            <div class="flex-1 min-w-0">
              <p class="text-sm font-medium text-gray-900 truncate">
                {{ metadata_file.blob_basename }}
              </p>
              <p class="text-sm text-gray-500 truncate">
                {{ metadata_file.creator }}
              </p>
              <p class="text-sm text-gray-500 truncate">
                {{ metadata_file.created }}
              </p>
            </div>
            <div>
              <a href="#" class="button is-primary is-sm">
                Check
              </a>
            </div>
          </div>
        </li>
      {% endfor %}
    </ul>
  </div>

  <div>
    <div class="h-12 my-8 relative">
      <span class="absolute flex font-bold text-lg items-center inset-y-0 left-1/2 -translate-x-1/2 py-2 px-3 bg-white z-20">OR</span>
      <hr class="absolute inset-x-0 top-1/2 z-10">
    </div>
    <div class="text-center">

      <button>upload new file</button>
      {{ form.media  }}
      <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        {{ form.as_p  }}
        <input type="submit" value="Check">
      </form>
    </div>
  </div>

  {% if request.method == 'POST' %}
    <div>
      <h4>Checkpoint 1 - {{ checkpoint.1.title }}</h4>
    </div>
    {% if checkpoint.1.run %}
      {% for problem in checkpoint.1.problems %}
        <div>
          {{ problem.message  }}
          {% if problem.context %}
            <div>
              {{ problem.context }}
            </div>
          {% endif %}
        </div>
      {% empty %}
        passed.
      {% endfor %}
    {% endif %}

    <div>
      <h4>Checkpoint 2 - {{ checkpoint.2.title }}</h4>
    </div>
    {% if checkpoint.2.run %}
      {% if checkpoint.2.problems %}
        <ul>
          {% for key, values in checkpoint.2.problems.items %}
            <li>
              <strong>{{ key.0 }}</strong> - {{ key.1 }} - lines: {{ values|slice:"5"|join:", " }}
              {% if values|length > 5 %}(and {{ values|length|add:"-5" }} more){% endif %}
            </li>
          {% endfor %}
        </ul>
      {% else %}
        passed.
      {% endif %}
    {% else %}
      skipped.
    {% endif %}

    <div>
      <h4>Checkpoint 3 - {{ checkpoint.3.title }}</h4>
    </div>
    {% if checkpoint.3.run %}
      {% if checkpoint.3.problems %}
        <ul>
          {% for key, values in checkpoint.3.problems.items %}
            <li>
              <strong>{{ key.0 }}</strong> - {{ key.1 }} - lines: {{ values|slice:"5"|join:", " }}
              {% if values|length > 5 %}(and {{ values|length|add:"-5" }} more){% endif %}
            </li>
          {% endfor %}
        </ul>
      {% else %}
        passed.
      {% endif %}
    {% else %}
      skipped.
    {% endif %}
  {% endif %}
{% endblock %}
