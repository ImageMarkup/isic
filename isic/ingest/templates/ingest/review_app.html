{% extends 'core/base.html' %}
{% load get_key %}

{% block head_extra %}
  <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/alpinejs/2.3.0/alpine.js" integrity="sha512-nIwdJlD5/vHj23CbO2iHCXtsqzdTTx3e3uAmpTm4x2Y8xCIFyWu4cSIV8GaGe2UNVq86/1h9EgUZy7tn243qdA==" crossorigin="anonymous"></script>
  {% include 'ingest/partials/review_header.html' %}
{% endblock %}

{% block content %}
  <div class="flex justify-between">
    {% include 'ingest/partials/breadcrumbs.html' %}
    {% include 'studies/partials/pagination.html' %}
  </div>

  {% if not page_obj %}
    There's nothing here to annotate!
  {% elif grouped_review_app %}
    {% for group in page_obj %}
      <div class="my-4" x-data="thumbnailGrid();">
        {% if title == 'Lesion Review' %}
          <span class="font-bold text-lg">{{ group }}</span>
        {% endif %}
        <div class="grid gap-4" :class="`grid-cols-${numCols}`">
          {% for accession in grouped_accessions|get_key:group %}
            {% include 'ingest/partials/accession.html' %}
          {% endfor %}
        </div>
      </div>

      <div class="relative">
        <div class="w-full border-t border-gray-300"></div>
      </div>
    {% endfor %}
  {% else %}
    <div class="mb-4" x-data="thumbnailGrid();">
      <div class="flex flex-row justify-end pb-3">
        <a class="px-1" href="#" @click="decrease();">fewer columns</a> |
        <a class="px-1" href="#" @click="increase();">more columns</a>
      </div>
      <div class="grid gap-4" :class="`grid-cols-${numCols}`">
        {% for accession in page_obj %}
          {% include 'ingest/partials/accession.html' %}
        {% endfor %}
      </div>
    </div>
  {% endif %}

  {% include 'studies/partials/pagination.html' %}

  {% if page_obj %}
    {% include 'ingest/partials/review_footer.html' %}
  {% endif %}

  {% include 'ingest/partials/thumbnail_grid_js.html' %}
{% endblock %}
